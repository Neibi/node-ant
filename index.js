// Generated by CoffeeScript 1.6.3
(function(){var e,t,n,r,i,s,o=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};t=function(){function e(){this.MESSAGE_SYSTEM_RESET=74;this.MESSAGE_CHANNEL_OPEN=75;this.MESSAGE_CHANNEL_CLOSE=76;this.MESSAGE_CHANNEL_REQUEST=77}return e}();e=function(e){function t(){this.selectStick=o(this.selectStick,this);this.init=o(this.init,this);t.__super__.constructor.call(this);this.stick=null}a(t,e);t.prototype.init=function(){};t.prototype.selectStick=function(e){switch(e){case"Garmin2":return this.stick=new r(4047,4104);case"Garmin3":return this.stick=new r(4047,4105)}};return t}(t);s=require("usb");n=function(){function e(){this.close=o(this.close,this);this.open=o(this.open,this);s.setDebugLevel(0);this.rawStart=["A4014A00EF","A4024D0054BF","A4094600B9A521FBBD72C34564","A40342000000E5","A4055100624D7901A7","A4024400FF1D","A4034300961F6D","A402450039DA","A4014B00EE"];this.rawStop=["A4014C00E9","A4014100E4","A4014A00EF"]}e.prototype.open=function(){return console.log("This driver does not the open command")};e.prototype.close=function(){return console.log("This driver does not the close command")};return e}();r=function(e){function t(e,n){this.callbackWriteToOutPoint=o(this.callbackWriteToOutPoint,this);this.writeStop=o(this.writeStop,this);this.writeStart=o(this.writeStart,this);this.open=o(this.open,this);var r=this;t.__super__.constructor.call(this);this.device=s.findByIds(e,n);this.device.open();this.iface=this.device.interfaces[0];this.iface.claim();this.inEndpoint=this.iface.endpoints[0];this.inEndpoint.startStream(1,64);this.inEndpoint.on("data",function(e){return console.log("RECIEVE:",e)});this.inEndpoint.on("error",function(e){return console.log(e)});this.inEndpoint.on("end",function(){return console.log("*****STOP RECIEVING*****")});this.outEndpoint=this.iface.endpoints[1]}a(t,e);t.prototype.open=function(){return console.log("working")};t.prototype.writeStart=function(e){var t,n,r,i,s,o;s=this.rawStart;o=[];for(r=0,i=s.length;r<i;r++){n=s[r];t=new Buffer(n,"hex");e.transfer(t,this.callbackWriteToOutPoint);o.push(console.log("WRITE:",t))}return o};t.prototype.writeStop=function(e){var t,n,r,i,s,o;s=this.rawStop;o=[];for(r=0,i=s.length;r<i;r++){n=s[r];t=new Buffer(n,"hex");e.transfer(t,this.callbackWriteToOutPoint);o.push(console.log("WRITE:",t))}return o};t.prototype.callbackWriteToOutPoint=function(e){if(e)return console.log(e)};return t}(n);i=new e;i.selectStick("Garmin3");i.stick.open()}).call(this);